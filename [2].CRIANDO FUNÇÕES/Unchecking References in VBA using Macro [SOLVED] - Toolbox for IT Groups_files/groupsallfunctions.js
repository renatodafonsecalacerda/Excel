var activeContainerID=0;var activeMessageID=0;var activeParentMessageID=0;function getPostBox(containerId,newClass,msgId,parentId){var oldContainerName="";var pBoxName=$("[replyBox=1]");var pBox=document.getElementById(pBoxName.attr("id"));var coAll;var tempTextAreaClass;var tempReplyBoxClass;var tempNewClass=newClass;var exAll;$("#selectedMessageID").html(msgId);pBox.style.display="block";coAll=document.getElementById("collapseAllLink");exAll=document.getElementById("expandAllLink");activeMessageID=msgId;activeParentMessageID=parentId;var container="";var jump="";if(parseInt(containerId)<0){container="topReplySection";}else{container="replyPlacementCell"+containerId;activeContainerID=containerId;}if(parseInt(curReplyIndex)!=parseInt(containerId)){var boxContainer=document.getElementById(container);if(boxContainer&&pBox){var postBody=$(".group_message_post_body:first").attr("id");var reloadMCEURL;if(postBody!=undefined&&postBody!=""){if(typeof tinyMCE!="undefined"){reloadMCEURL=tinyMCE.activeEditor.baseURI.source;tinyMCE.execCommand("mceRemoveControl",false,postBody);}}boxContainer.style.display="block";boxContainer.appendChild(pBox);pBox.style.display="block";var lastContainer=document.getElementById("replyPlacementCell"+curReplyIndex);if(curReplyIndex<0){oldContainerName="topReplySection";}else{oldContainerName="replyPlacementCell"+curReplyIndex;}var lastContainer=document.getElementById(oldContainerName);if(lastContainer){lastContainer.style.display="none";}curReplyIndex=containerId;tempNewClass="";if(reloadMCEURL&&reloadMCEURL!=""){InitTinyMCECallback(postBody,"","",reloadMCEURL,function(){formatLoading.hide();});}}}tempReplyBoxClass="KBgroups_replyBox_Off";tempTextAreaClass="KBgroups_textarea_Off";tempNewClass="";if(pBox){pBox.className=tempReplyBoxClass;}var objName=(parseInt(containerId)<0)?"topReplyPoint":"replyPlacementCell"+containerId;var pBox2=document.getElementById(objName);if(pBox2){window.scroll(0,findPos(pBox2)[1]-howFarY(pBox2));}}var toggleState=0;var displayValue="block";var replyDisplayValue="none";var toggleLinkText="Expand All";var curReplyIndex=-1;var curMoveIncrement=0;function findPos(obj){var curleft=curtop=0;if(obj.offsetParent){curleft=obj.offsetLeft;curtop=obj.offsetTop;while(obj=obj.offsetParent){curleft+=obj.offsetLeft;curtop+=obj.offsetTop;}}return[curleft,curtop];}function cFc(fld,cCount){if(fld){if(parseInt(fld.value.length)>=parseInt(cCount)){return true;}else{return false;}}return false;}function validateEmail(txt){var tfld=txt;var email=/^[^@]+@[^@.]+\.[^@]*\w\w$/;var checkStr=tfld.toString();if(!email.test(tfld)){return false;}else{return true;}}function finalValidate(){var returnValue=true;var sErrorText="";var pEml=document.getElementById("postEmail");var pBody=document.getElementById("postBody");if(!validateEmail(pEml.value)){returnValue=false;sErrorText="- Please provide your valid e-mail address.\n";}if(!cFc(pBody,1)){returnValue=false;sErrorText+="- Please type in your reply.";}if(!returnValue){alert("Required fields are missing in your post:\n--------------------------------------------------\n\n"+sErrorText+"\n");}else{var strReply;var messageContainer=document.getElementById("reply_"+activeContainerID);var originalMessageContainer=document.getElementById("OriginalMessage");if(messageContainer&&originalMessageContainer){strReply=messageContainer.innerHTML;strReply=strReply.replace(/[\r]/g,"");strReply=strReply.replace(/<BR[\/]?>/gi,"\n");strReply=strReply.replace(/<\/?[\s\S]*?>/gi,"");originalMessageContainer.value="\n\n-----Original Message-----\n"+strReply;}}return returnValue;}var docheight,docwidth,scroll_top,scroll_left,ie,standardbody;function aj_BookmarkAction(pActionType,pEntityId,pMessageId){var ajaxUrl;var runAjax=false;if(typeof(pActionType)!="undefined"){if(pEntityId=="0"||pEntityId==""){tempPop(3);return;}if(pActionType<0){aj_BookmarkAddedAlert(3);return;}else{if(parseInt(pActionType)==2){if(typeof(watchUrl)!="undefined"){if(typeof(pEntityId)!="undefined"){if(pEntityId>0){ajaxUrl="/ajax/aj_watchactions.asp?bmid="+pEntityId+"&ptype="+pActionType;PageMethods.threadWatchFunctions(pEntityId,pActionType,aj_BookmarkActionResponse,OnFailed,null);runAjax=true;}}}}else{if(pActionType==1){if(typeof(watchUrl)!="undefined"){if(typeof(pMessageId)!="undefined"){if(pMessageId>0){ajaxUrl="/ajax/aj_watchactions.asp?msid="+pMessageId+"&ueid="+pEntityId+"&ptype="+pActionType+"&rurl="+parentUrlForWatch;PageMethods.threadWatchFunctions(pMessageId,pEntityId,pActionType,parentUrlForWatch,aj_BookmarkActionResponse,OnFailed,null);runAjax=true;}}}}}}if(runAjax==true){}}}var BookmarkTransport;function OnFailed(error){alert(error.get_message());}function OnSuccess(result){alert(result);}function aj_BookmarkActionResponse(pData){var returnText,bookmarkButton;returnText=pData;if(returnText!="fail"){aj_BookmarkAddedAlert(returnText);if(parseInt(returnText)==2){bookmarkButton="KBgroups_watchButton.gif";buildBookmarkLink(1,curUserEntityId,watchParentId,buttonLocation+bookmarkButton);}else{bookmarkButton="KBgroups_unwatchButton.gif";buildBookmarkLink(2,returnText,"0",buttonLocation+bookmarkButton);}}else{alert(returnText);status="Bookmarking failure";}}function buildBookmarkLink(actionId,pId1,pId2,imgSrc){var newImg=document.createElement("IMG");newImg.setAttribute("src",imgSrc);newImg.border=0;if(parseInt(actionId)==1){}else{}newImg.id="anotherimage";var nLink=document.createElement("a");nLink.appendChild(newImg);nLink.href="#";nLink.id="watchActionLink";nLink.onclick=function(){aj_BookmarkAction(actionId,pId1,pId2);};var linkParent=document.getElementById("bookmarkButtonContainer");linkParent.innerHTML="";linkParent.appendChild(nLink);var setImg=document.getElementById("anotherimage");setImg.style.display="none";setImg.style.display="inline";}function aj_BookmarkAddedAlert(BookmarkReturn){tempPop(BookmarkReturn);}function getBookmarkText(pRepCode){var arrayText=new Array("You are now watching this thread. <a href='"+watchUrl+"'>Click here</a> to view your watched threads.","You are no longer watching this thread. <a href='"+watchUrl+"'>Click here</a> to view your watched threads.","To start watching this thread, please <a href='"+strUserManagementUrl+"signin.asp?r="+selfUrl+"'>Sign in</a> or <a href='"+strUserManagementUrl+"connect/'>Register</a> for an ITtoolbox account. Once you are signed in, please click the <i>Watch this Thread</i> button on this page again.");var aTitles=new Array("Watch Added","Watch Removed","Please Register");var responseText=arrayText[pRepCode-1];var titleText=aTitles[pRepCode-1];var tempText="<table border=0 cellspacing=0 cellpadding=0 width=490><tr><td style='font: bold 16px arial; padding-top:10px; padding-left:20px'>"+titleText+"</td>";tempText=tempText+"<td align=right><a href='javascript:void(0);' onClick=closeMe('BookmarkBox'); title='Close Watch Box'><img src='http://images.ittoolbox.com/KB/groups/KBgroups_watchCloseButton.gif' border=0 style='margin-right:15px; margin-top:8px'></A>";tempText=tempText+"</tr><tr>";tempText=tempText+"<td colspan=2 class=KBgroups_watchInner>"+responseText;tempText=tempText+"<br/>";tempText=tempText+"<div style='margin-top:10px; text-align:right;'><a href=\"javascript:closeMe('BookmarkBox')\">Close</a></div></td></tr>";tempText=tempText+"</table>";return tempText;}var BookmarkBox;function tempPop(returnText){BookmarkBox=createWindow();document.body.appendChild(BookmarkBox);setSize(BookmarkBox,490,163);centerMe(BookmarkBox);var responseIndex=(parseInt(returnText)>3)?1:returnText;BookmarkBox.innerHTML=getBookmarkText(responseIndex);}function setSize(wnObj,w,h){wnObj.style.width=parseInt(w)+"px";wnObj.style.height=parseInt(h)+"px";}function centerMe(wnObj){getWindowData();wnObj.style.left=scroll_left+(docwidth-wnObj.offsetWidth)/2+"px";wnObj.style.top=scroll_top+(docheight-wnObj.offsetHeight)/2+"px";}function howFarX(destinationObj){return parseInt(scroll_left+(docwidth-destinationObj.offsetWidth)/2);}function howFarY(destinationObj){getWindowData();return parseInt((docheight-destinationObj.offsetHeight)/2);}function closeMe(obj){var sucbox=document.getElementById(obj);if(sucbox){document.body.removeChild(sucbox);suchbox=null;}}function createWindow(){var domwindow=document.createElement("div");domwindow.id="BookmarkBox";return domwindow;}function getWindowData(){var ie=document.all&&!window.opera;var domclientWidth=document.documentElement&&parseInt(document.documentElement.clientWidth)||100000;standardbody=(document.compatMode=="CSS1Compat")?document.documentElement:document.body;scroll_top=(ie)?standardbody.scrollTop:window.pageYOffset;scroll_left=(ie)?standardbody.scrollLeft:window.pageXOffset;docwidth=(ie)?standardbody.clientWidth:(/Safari/i.test(navigator.userAgent))?window.innerWidth:Math.min(domclientWidth,window.innerWidth-16);docheight=(ie)?standardbody.clientHeight:window.innerHeight;}function URLencode(sStr){return escape(sStr).replace(/\+/g,"%2B").replace(/\"/g,"%22").replace(/\'/g,"%27").replace(/\//g,"%2F");}function openConfirm(msgID){var rbFlag=parseInt($("#rbFlag").val());if(msgID>0&&rbFlag==0){$("#rbFlag").val(1);$("#cBest"+msgID).fadeOut("fast");$("#cBest"+msgID).fadeIn("fast");}}function openWikiEdit(msgID,userstate,editorID,TinyMCEJSURL){alert("here");if(userstate==0){$("#joinheader").children("h1").html("Sign up to improve this answer");$("#regOptions").val(msgID);ShowRegistration("VoteUp");}else{$("#bestAnswerEdit").show();$("#messagetext").hide();$("#contribs").hide();$(".editbuttonpanel").hide();$("#baTitle").html("Improve this Answer");$("#lestedit").hide();$("#formattinghelp").show();scrollToElement($("#bestansweranchor"));}}function closeWikiEdit(){$("#messagetext").show();$("#bestAnswerEdit").hide();$(".editbuttonpanel").show();$("#baTitle").html("Best Answer");$("#lestedit").show();$("#formattinghelp").hide();$("#contribs").show();}function scrollToElement(ele){$(window).scrollTop(ele.offset().top).scrollLeft(ele.offset().left);}function openFormatHelp(){if($("#formathelppanel").css("display")=="none"){$("#formathelppanel").show();}else{$("#formathelppanel").hide();}}function closeConfirm(msgID){if(msgID>0){var rbFlag=parseInt($("#rbFlag").val());$("#rbFlag").val(0);$("#cBest"+msgID).fadeIn("fast");$("#cBest"+msgID).fadeOut("fast");}else{$("#bestAnswerEdit").hide();}}function rateBest(msgID,communityId,msgBody,entityId){if(msgID>0&&entityId>0&&communityId>0){msgBody=encodeURI(msgBody);closeConfirm(msgID);$("#loading"+msgID).show();$.ajax({type:"POST",url:"/api/GroupMessage.aspx/RateBest",data:({messageId:msgID,entityId:entityId,communityId:communityId,msgBody:msgBody}),success:function(data,msgBody){location.reload();},error:function(XMLHttpRequest,textStatus,errorThrown){onBestAnswerFail(errorThrown,null,null);}});}else{if(msgID>0){$("#rateMsg"+msgID).fadeIn("fast");$("#rateMsg"+msgID).queue(function(){setTimeout(function(){$("#rateMsg"+msgID).dequeue();},3000);});$("#rateMsg"+msgID).fadeOut("fast");}}}function savetoWiki(msgID,msgBody,entityID){if(msgID>0){tempmsg="loading...";msgBody=encodeURI(msgBody);entityID=encodeURI(entityID);$("#saveloading").show();$.ajax({type:"POST",url:"/api/GroupMessage.aspx/SaveToWiki",data:({messageId:msgID,msgBody:msgBody,entityID:entityID}),success:function(data){$("#messagetext").html(tempmsg);$("#messagetext").show();$(".ach_confirm").hide();$("#bestAnswerEdit").hide();$(".editbuttonpanel").show();$("#saveloading").hide();$("#baTitle").html("Best Answer");$("#lestedit").show();window.location.reload();},error:function(XMLHttpRequest,textStatus,errorThrown){onBestAnswerFail(errorThrown,null,null);}});}}function onBestAnswerSuccess(result,userContext,methodName,msgBody){var results=result.split(",");$("#loading"+results[0]).hide();if(results[1]!=null&&results[1]!=""){$("#rateMsg"+results[0]).text(results[1]);$("#rateMsg"+results[0]).fadeIn("fast");$("#rateMsg"+results[0]).queue(function(){setTimeout(function(){$("#rateMsg"+results[0]).dequeue();},2000);});$("#rateMsg"+results[0]).fadeOut("fast");}if(results[2]!=""){var count=eval(results[2]);if(count>0){var msgId=results[0];setBestAnswerStyle(msgId);var total=eval(document.getElementById("replyCount").value);for(i=0;i<total;i++){$("#T"+i).hide();}}}}function onBestAnswerFail(result,userContext,methodName){var results=result.split(",");$("#loading"+results[0]).hide();$("#rateMsg"+results[0]).text(result);$("#rateMsg"+results[0]).fadeIn("fast");$("#rateMsg"+results[0]).queue(function(){setTimeout(function(){$("#rateMsg"+results[0]).dequeue();},2000);});$("#rateMsg"+results[0]).fadeOut("fast");}function setBestAnswerStyle(baId){var reply=document.getElementById("GRB"+baId);reply.onmouseover=null;reply.onmouseout=null;var bestTitle=document.getElementById("B"+baId);bestTitle.style.visibility="visible";bestTitle.style.display="block";}function rateHandler(msgID,entityId,communityId){var rbFlag=parseInt($("#rbFlag").val());if(rbFlag>0){return;}if(msgID>0&&entityId>0&&communityId>0){$("#loading"+msgID).show();$.ajax({type:"POST",url:"/api/GroupMessage.aspx/ProcessVote",data:({messageId:msgID,entityId:entityId,communityId:communityId}),success:function(data){onSucceeded(data,null,null);},error:function(XMLHttpRequest,textStatus,errorThrown){onFailed(errorThrown,null,null);}});}else{if(msgID>0){$("#joinheader").children("h1").html("Sign up to cast your vote");$("#regOptions").val(msgID);ShowRegistration("VoteUp");}}}function ShowRegistration(subProduct){$("object").each(function(i,val){if($(val).css("display")!="none"){$(val).attr("mhiddenad",$(val).css("display"));$(val).hide();}});setSubProductOverride(subProduct);$("#signin").css("z-index","100");$("#lightbox-panel").show();$(window).scrollTop(0);$("#OnPageRegistration").show();$('input[class*="onPageRegEmail"]').focus();}function CloseRegistration(){$("#OnPageRegistration").hide();$("#lightbox-panel").hide();$("#signin").css("z-index","1000");$("[mhiddenad]").each(function(i,val){$(val).css("display",$(val).attr("mhiddenad"));});$("#joinheader").children("h1").html("Solve problems - It's Free");$("#regOptions").val("");}function voteHandler(contentID,entityID,communityID){var smDivID;var e;if(contentID>0&&entityID>0&&communityID>0){smDivID="loading"+contentID;e=document.getElementById(smDivID);showElem(e,true);$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:"/api/vote/",data:({entityid:entityID,contentLocalId:contentID,community:communityID}),dataType:"json",cache:false,success:function(msg){var resultdata=(typeof msg)=="string"?eval("("+msg+")"):msg;var smDivID="rateMsg"+resultdata.vote[0].contentlocalid;var loadingDivID="loading"+resultdata.vote[0].contentlocalid;var ratingCountSpan="S"+resultdata.vote[0].contentlocalid;var e=document.getElementById(smDivID);var eLoading=document.getElementById(loadingDivID);var eRating=document.getElementById(ratingCountSpan);e.innerHTML=resultdata.vote[0].text;if(resultdata.vote[0].votes!=""){eRating.innerHTML=resultdata.vote[0].votes;}showElem(e,true);showElem(eLoading,false);setTimeout("showElem(document.getElementById('"+smDivID+"'), false);",2500);},error:function(XMLHttpRequest,textStatus,errorThrown){var smDivID="rateMsg"+contentID;var loadingDivID="loading"+contentID;var e=document.getElementById(smDivID);var eLoading=document.getElementById(loadingDivID);e.innerHTML="Please try again later.";showElem(e,true);showElem(eLoading,false);setTimeout("showElem(document.getElementById('"+smDivID+"'), false);",2500);}});}else{if(contentID>0){smDivID="rateMsg"+contentID;e=document.getElementById(smDivID);showElem(e,true);setTimeout("showElem(document.getElementById('"+smDivID+"'), false);",5000);}}}function onSucceeded(result,userContext,methodName){var results=result.split(",");$("#loading"+results[0]).hide();$("#rateMsg"+results[0]).text(results[1]);$("#rateMsg"+results[0]).fadeIn("fast");$("#rateMsg"+results[0]).queue(function(){setTimeout(function(){$("#rateMsg"+results[0]).dequeue();},2000);});$("#rateMsg"+results[0]).fadeOut("fast");if(results[2]!=""){$("#S"+results[0]).text(results[2]);}}function onFailed(result,userContext,methodName){var results=result.split(",");$("#loading"+results[0]).hide();$("#rateMsg"+results[0]).text(result);$("#rateMsg"+results[0]).fadeIn("fast");$("#rateMsg"+results[0]).queue(function(){setTimeout(function(){$("#rateMsg"+results[0]).dequeue();},2000);});$("#rateMsg"+results[0]).fadeOut("fast");}function showElem(elem,show){if(elem!=null){elem.style.display=(show)?"block":"none";}}function SetActiveMessge(e,msgID,count,showMarkHelpful){var baId=parseInt($("#baId").val());if(msgID==baId){return;}if(showMarkHelpful.toLowerCase()=="true"){var replyLink=document.getElementById("replyLinkSection"+count);showElem(replyLink,true);var toTopLink=document.getElementById("toTopLink"+count);showElem(toTopLink,true);var voteImage=document.getElementById("imgHelpful"+msgID);showElem(voteImage,true);}else{var voteImage=document.getElementById("imgHelpful"+msgID);showElem(voteImage,false);}}function MakeNormal(e,msgID,count,showMarkHelpful){var baId=parseInt($("#baId").val());if(msgID==baId){return;}if(showMarkHelpful.toLowerCase()=="true"){var replyLink=document.getElementById("replyLinkSection"+count);showElem(replyLink,false);var toTopLink=document.getElementById("toTopLink"+count);showElem(toTopLink,false);}}function closeEmailDiv(msgId){var emailDivID="emailDiv"+msgId;var e=document.getElementById(emailDivID);showElem(e,false);}
