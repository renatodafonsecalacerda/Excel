
<!-- saved from url=(0046)http://www.contextures.com/xlautofilter03.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Excel Filters -- AutoFilter VBA</title>
<meta name="Description" content="With Excel AutoFilter VBA create macros to show all records, hide filter arrows, copy filtered rows and count visible rows.">
<meta name="KeyWords" content="Excel autofilter VBA, Excel autofilter, Excel filter macro, autofilter, Excel autofilter macro, Excel filter, Excel AutoFilter programming">
<link rel="author" href="https://plus.google.com/108279571932575172220/%3Cscript%20language=" javascript"="">

<link rel="stylesheet" href="http://www.contextures.com/myCSS01.css">
</head><body bgcolor="#FFFFFF" link="#0066cc" vlink="#006666" alink="#996699">

<blockquote> <!-- #BeginLibraryItem "/Library/header.lbi" --><table cellspacing="0" cellpadding="0" border="0" width="912">
    <tbody><tr> 
      <td height="15" colspan="3" valign="top"> 
        <p align="left"><a href="http://www.contextures.com/index.html" class="logo" style="width: 445px; height: 69px">Contextures - Microsoft Excel Tips and Tutorials </a> 
        </p>
      </td>
      <td height="15" width="393" valign="top"> <font face="Arial, Helvetica, sans-serif" size="1">Search 
        Contextures Sites</font> 
        <style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
        <div class="cse-branding-bottom" style="background-color:#FFFFFF;color:#000000"> 
          <div class="cse-branding-form"> 
            <form action="http://www.contextures.com/searchresultsctx.html" id="cse-search-box">
              <div> 
                <input type="hidden" name="cx" value="partner-pub-9531091850463532:8aijyv3fez1">
                <input type="hidden" name="cof" value="FORID:10">
                <input type="hidden" name="ie" value="ISO-8859-1">
                <input type="text" name="q" size="31">
                <input type="submit" name="sa" value="Search">
              </div>
            </form>
          </div>
          <div class="cse-branding-logo"> <img src="./Excel Filters -- AutoFilter VBA_files/poweredby_FFFFFF.gif" alt="Google"> 
          </div>
        </div>
        <div class="cse-branding-bottom" style="background-color:#FFFFFF;color:#000000">
          <div class="cse-branding-logo"> </div>
        </div>
        <div class="cse-branding-bottom" style="background-color:#FFFFFF;color:#000000"> 
          <div class="cse-branding-text"> </div>
        </div>
        <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000"> 
          <div class="cse-branding-text"> </div>
        </div>
        <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000"></div>
      </td>
    </tr>
  </tbody></table>
  <div id="navbar"> 
    
  <ul>
    <li><a href="http://www.contextures.com/">Home</a></li>
    <li><a href="http://www.contextures.com/tiptech.html">Excel Tips</a></li>
    <li><a href="http://www.contextures.com/excelfiles.html">Excel Files</a></li>
    <li><a href="http://www.contextures.com/contexturesproducts.html">Products</a></li>
    <li><a href="http://www.contextures.com/ExcelVideoTutorials.html">Videos</a></li>
    <li><a href="http://blog.contextures.com/">Blog</a></li>
    <li><a href="http://www.contextures.com/consult.html">Contact</a> </li>
    <li><a href="http://www.contextures.com/feed.xml">RSS</a></li>
  </ul>
  </div><!-- #EndLibraryItem --> 
  <p> 
    <script async="" type="text/javascript" src="./Excel Filters -- AutoFilter VBA_files/ca-pub-9531091850463532.js"></script><script type="text/javascript"><!--
google_ad_client = "pub-9531091850463532";
/* 728x90, created 2/17/09 */
google_ad_slot = "7225918926";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
    <script type="text/javascript" src="./Excel Filters -- AutoFilter VBA_files/show_ads.js">
</script><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe width="728" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
  </p>
<table cellspacing="0" cellpadding="0" border="0" width="95%">
    <tbody><tr> 
      <td valign="top" rowspan="18" width="180"> 
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center"><!-- AWeber Web Form Generator 3.0 --> 
          <style type="text/css">
#af-form-1175035544 .af-body .af-textWrap{width:98%;display:block;float:none;}
#af-form-1175035544 .af-body .privacyPolicy{color:#000000;font-size:11px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .af-body a{color:#094C80;text-decoration:underline;font-style:normal;font-weight:normal;}
#af-form-1175035544 .af-body input.text, #af-form-1175035544 .af-body textarea{background-color:#FFFFFF;border-color:#919191;border-width:1px;border-style:solid;color:#000000;text-decoration:none;font-style:normal;font-weight:normal;font-size:12px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .af-body input.text:focus, #af-form-1175035544 .af-body textarea:focus{background-color:#FFFAD6;border-color:#030303;border-width:1px;border-style:solid;}
#af-form-1175035544 .af-body label.previewLabel{display:block;float:none;text-align:left;width:auto;color:#000000;text-decoration:none;font-style:normal;font-weight:normal;font-size:12px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .af-body{padding-bottom:15px;padding-top:15px;background-repeat:no-repeat;background-position:inherit;background-image:none;color:#000000;font-size:11px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .af-header{padding-bottom:9px;padding-top:9px;padding-right:10px;padding-left:10px;background-image:url('http://forms.aweber.com/images/auto/body/009/5ff/005/999');background-position:top left;background-repeat:repeat-x;background-color:#005999;border-color:#1FB824;border-width:5px;border-bottom-style:solid;border-left-style:none;border-right-style:none;border-top-style:none;color:#FFFFFF;font-size:16px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .af-quirksMode .bodyText{padding-top:2px;padding-bottom:2px;}
#af-form-1175035544 .af-quirksMode{padding-right:15px;padding-left:15px;}
#af-form-1175035544 .af-standards .af-element{padding-right:15px;padding-left:15px;}
#af-form-1175035544 .bodyText p{margin:1em 0;}
#af-form-1175035544 .buttonContainer input.submit{background-image:url("http://forms.aweber.com/images/auto/gradient/button/07c.png");background-position:top left;background-repeat:repeat-x;background-color:#0057ac;border:1px solid #0057ac;color:#FFFFFF;text-decoration:none;font-style:normal;font-weight:normal;font-size:14px;font-family:Verdana, sans-serif;}
#af-form-1175035544 .buttonContainer input.submit{width:auto;}
#af-form-1175035544 .buttonContainer{text-align:right;}
#af-form-1175035544 body,#af-form-1175035544 dl,#af-form-1175035544 dt,#af-form-1175035544 dd,#af-form-1175035544 h1,#af-form-1175035544 h2,#af-form-1175035544 h3,#af-form-1175035544 h4,#af-form-1175035544 h5,#af-form-1175035544 h6,#af-form-1175035544 pre,#af-form-1175035544 code,#af-form-1175035544 fieldset,#af-form-1175035544 legend,#af-form-1175035544 blockquote,#af-form-1175035544 th,#af-form-1175035544 td{float:none;color:inherit;position:static;margin:0;padding:0;}
#af-form-1175035544 button,#af-form-1175035544 input,#af-form-1175035544 submit,#af-form-1175035544 textarea,#af-form-1175035544 select,#af-form-1175035544 label,#af-form-1175035544 optgroup,#af-form-1175035544 option{float:none;position:static;margin:0;}
#af-form-1175035544 div{margin:0;}
#af-form-1175035544 fieldset{border:0;}
#af-form-1175035544 form,#af-form-1175035544 textarea,.af-form-wrapper,.af-form-close-button,#af-form-1175035544 img{float:none;color:inherit;position:static;background-color:none;border:none;margin:0;padding:0;}
#af-form-1175035544 input,#af-form-1175035544 button,#af-form-1175035544 textarea,#af-form-1175035544 select{font-size:100%;}
#af-form-1175035544 p{color:inherit;}
#af-form-1175035544 select,#af-form-1175035544 label,#af-form-1175035544 optgroup,#af-form-1175035544 option{padding:0;}
#af-form-1175035544 table{border-collapse:collapse;border-spacing:0;}
#af-form-1175035544 ul,#af-form-1175035544 ol{list-style-image:none;list-style-position:outside;list-style-type:disc;padding-left:40px;}
#af-form-1175035544,#af-form-1175035544 .quirksMode{width:161px;}
#af-form-1175035544.af-quirksMode{overflow-x:hidden;}
#af-form-1175035544{background-color:#F0F0F0;border-color:#CFCFCF;border-width:1px;border-style:solid;}
#af-form-1175035544{display:block;}
#af-form-1175035544{overflow:hidden;}
.af-body .af-textWrap{text-align:left;}
.af-body input.image{border:none!important;}
.af-body input.submit,.af-body input.image,.af-form .af-element input.button{float:none!important;}
.af-body input.text{width:100%;float:none;padding:2px!important;}
.af-body.af-standards input.submit{padding:4px 12px;}
.af-clear{clear:both;}
.af-element label{text-align:left;display:block;float:left;}
.af-element{padding:5px 0;}
.af-form-wrapper{text-indent:0;}
.af-form{text-align:left;margin:auto;}
.af-header{margin-bottom:0;margin-top:0;padding:10px;}
.af-quirksMode .af-element{padding-left:0!important;padding-right:0!important;}
.lbl-right .af-element label{text-align:right;}
body {
}
</style>
        </p>
        <form method="post" class="af-form-wrapper" action="http://www.aweber.com/scripts/addlead.pl" target="_new">
          <div style="display: none;"> 
            <input type="hidden" name="meta_web_form_id" value="1175035544">
            <input type="hidden" name="meta_split_id" value="">
            <input type="hidden" name="listname" value="ctxtips01">
            <input type="hidden" name="redirect" value="http://www.aweber.com/thankyou-coi.htm?m=text" id="redirect_e7cf39d35e8127a8e487c1a8a1dbc7a2">
            <input type="hidden" name="meta_adtracking" value="ExcelTipsSignup">
            <input type="hidden" name="meta_message" value="1">
            <input type="hidden" name="meta_required" value="email">
            <input type="hidden" name="meta_tooltip" value="">
          </div>
          <div id="af-form-1175035544" class="af-form"> 
            <div id="af-header-1175035544" class="af-header"> 
              <div class="bodyText"> 
                <p style="text-align: center;">Contextures<br>
                  <strong>Excel news</strong><br>
                  by email<strong></strong></p>
              </div>
            </div>
            <div id="af-body-1175035544" class="af-body af-standards"> 
              <div class="af-element"> <label class="previewLabel" for="awf_field-29885385">Email: 
                </label> 
                <div class="af-textWrap"> 
                  <input class="text" id="awf_field-29885385" type="text" name="email" value="" tabindex="500">
                </div>
                <div class="af-clear"></div>
              </div>
              <div class="af-element"> <label class="previewLabel" for="awf_field-29885386">Name 
                (optional): </label> 
                <div class="af-textWrap"> 
                  <input id="awf_field-29885386" type="text" name="name" class="text" value="" tabindex="501">
                </div>
                <div class="af-clear"></div>
              </div>
              <div class="af-element buttonContainer"> 
                <input name="submit" class="submit" type="submit" value="Sign up" tabindex="502">
                <div class="af-clear"></div>
              </div>
              <div class="af-element privacyPolicy" style="text-align: center"> 
                <p><a title="Privacy Policy" href="http://www.aweber.com/permission.htm" target="_blank">We 
                  respect your email privacy</a></p>
                <div class="af-clear"></div>
              </div>
            </div>
          </div>
          <div style="display: none;"><img src="./Excel Filters -- AutoFilter VBA_files/displays.htm" alt=""></div>
        </form>
        <script type="text/javascript">
    <!--
    (function() {
        var IE = /*@cc_on!@*/false;
        if (!IE) { return; }
        if (document.compatMode && document.compatMode == 'BackCompat') {
            if (document.getElementById("af-form-1175035544")) {
                document.getElementById("af-form-1175035544").className = 'af-form af-quirksMode';
            }
            if (document.getElementById("af-body-1175035544")) {
                document.getElementById("af-body-1175035544").className = "af-body inline af-quirksMode";
            }
            if (document.getElementById("af-header-1175035544")) {
                document.getElementById("af-header-1175035544").className = "af-header af-quirksMode";
            }
            if (document.getElementById("af-footer-1175035544")) {
                document.getElementById("af-footer-1175035544").className = "af-footer af-quirksMode";
            }
        }
    })();
    -->
</script>
        <!-- /AWeber Web Form Generator 3.0 --> 
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center"> 
          <script type="text/javascript"><!--
google_ad_client = "pub-9531091850463532";
/* 160x600, ATF Left 11/7/10 */
google_ad_slot = "5946369582";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
          <script type="text/javascript" src="./Excel Filters -- AutoFilter VBA_files/show_ads.js">
</script><ins id="aswift_1_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><iframe width="160" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
        </p>
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center"><!--Begin---> <a href="http://www.exceluser.com/cmd.php?Clk=1197043"><img src="./Excel Filters -- AutoFilter VBA_files/info_dash_d03.gif" alt="Learn how to create Excel dashboards." width="120" height="600" border="0"></a> 
          <br>
          <img src="./Excel Filters -- AutoFilter VBA_files/cmd.php" width="0" height="0" border="0"> 
          <!--End---> </p>
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center">&nbsp;</p>
        <p align="center"> 
          <script type="text/javascript"><!--
google_ad_client = "pub-9531091850463532";
/* 160x600, ATF Left 11/7/10 */
google_ad_slot = "5946369582";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
          <script type="text/javascript" src="./Excel Filters -- AutoFilter VBA_files/show_ads.js">
</script><ins id="aswift_2_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><iframe width="160" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
        </p>
        <div class="style1"> 
          <p>&nbsp;</p>
          <p align="center">&nbsp;</p>
          <div class="style1"> <!--Begin---> 
            <div align="center"><a href="http://www.exceluser.com/cmd.php?Clk=4244691"><img src="./Excel Filters -- AutoFilter VBA_files/ani_140x200_traf01.gif" alt="Your worksheet formulas can create traffic-light charts, highlight chart elements, assign number formats, and more." width="140" height="200" border="0"></a> 
              <br>
              <img src="./Excel Filters -- AutoFilter VBA_files/cmd(1).php" width="0" height="0" border="0"> 
              <!--End---> </div>
          </div>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center"><a href="https://www.e-junkie.com/ecom/gb.php?cl=84674&c=ib&aff=70888" target="ejejcsingle"><img src="./Excel Filters -- AutoFilter VBA_files/charttoolad139x482.png" width="139" height="482" border="0"></a></p>
        <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center"> </p>
          <p align="center"><!--Begin---> <a href="http://www.exceluser.com/cmd.php?Clk=1197043"><img src="./Excel Filters -- AutoFilter VBA_files/info_dash_d03.gif" alt="Learn how to create Excel dashboards." width="120" height="600" border="0"></a> 
            <br>
            <img src="./Excel Filters -- AutoFilter VBA_files/cmd.php" width="0" height="0" border="0"> 
            <!--End---></p>
          <p align="center">&nbsp;</p>
          <p align="center"></p>
          <p>&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center"><a href="http://www.contextures.com/30excelfunctionsin30days01.html"><img text="30 Excel Functions in 30 Days" src="./Excel Filters -- AutoFilter VBA_files/30xl30dCover_180x234.png" width="180" height="234" border="1" alt="30 Excel Functions in 30 Days"></a></p>
          <p>&nbsp;</p>
          <p>&nbsp;</p>
          <p>&nbsp;</p>
          <p align="center"><!--Begin---> <a href="http://www.exceluser.com/cmd.php?Clk=2511398"><img src="./Excel Filters -- AutoFilter VBA_files/info_dash_a07.gif" alt="Learn how to create Excel dashboards." width="180" height="150" border="0"></a> 
            <br>
            <img src="./Excel Filters -- AutoFilter VBA_files/cmd(2).php" width="0" height="0" border="0"> 
            <!--End---></p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center">&nbsp;</p>
          <p align="center"><a href="http://www.contextures.com/xlPivotPremAddIn.html"><img src="./Excel Filters -- AutoFilter VBA_files/PPP_160x274.png" width="160" height="274" border="0"></a></p>
          <p align="center"><a href="http://www.contextures.com/xlPivotPremAddIn.html">Time-saving<br>
            Pivot Table add-in</a></p>
          <p align="center">&nbsp;</p>
        </div>
      </td>
      <td height="40" valign="top" rowspan="18">&nbsp;</td>
      <td height="40" colspan="4" valign="top" rowspan="18"> 
        <blockquote> 
          <h1><a name="Top"></a>Excel Filters -- AutoFilter VBA</h1>
          <p>Examples of AutoFilter VBA programming, for use with worksheet AutoFilters 
            (only one allowed per worksheet). </p>
          <p><a href="http://www.contextures.com/xlautofilter03.html#All">Show All Records</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#allprotect">Show All Records on Protected Sheet</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#allpwd">Show All Records on Password Protected Sheet</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#On">Turn On Excel AutoFilter</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#Off">Turn Off Excel AutoFilter</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#ungroup">Ungroup Dates in Filter Drop Down</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#countfilters">Count Worksheet AutoFilters</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#Hide">Hide Excel AutoFilter Arrows</a> <br>
            <a href="http://www.contextures.com/xlautofilter03.html#Copy">Copy Filtered Rows</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#Protect">Excel AutoFilter on a Protected Worksheet</a><br>
            <a href="http://www.contextures.com/xlautofilter03.html#Count">Count Visible Rows</a><br>
          </p>
          <p>Also see: <a href="http://www.contextures.com/excelautofilterlist.html">Excel List AutoFilter 
            VBA</a> <br>
            and <a href="http://www.contextures.com/xlautofilter01.html">Excel AutoFilter Basics </a></p>
          <h2><a name="All"></a>Show All Records <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></h2>
          <p>The following Excel AutoFilter VBA code shows all records, if a filter 
            has been applied.</p>
          <p><img src="./Excel Filters -- AutoFilter VBA_files/AuF20.gif" width="175" height="72" border="1"></p>
          <pre>Sub ShowAllRecords()
  If ActiveSheet.FilterMode Then
    ActiveSheet.ShowAllData
  End If
End Sub</pre>
          <h2><a name="allprotect"></a>Show All Records on Protected Sheet<a href="http://www.contextures.com/xlautofilter03.html#Top"> 
            <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></h2>
          <p>If the worksheet is protected, with <b>no password</b>, use this 
            code to unprotect it, show all, then turn the protection back on. 
          </p>
          <pre>Sub ShowAllProtected()

With ActiveSheet
    .Unprotect
    .ShowAllData
    .Protect _
        Contents:=True, _
        AllowFiltering:=True, _
        UserInterfaceOnly:=True
End With

End Sub
</pre>
          <h2><a name="allpwd"></a>Show All Records on Password Protected Sheet<a href="http://www.contextures.com/xlautofilter03.html#Top"> 
            <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></h2>
          <p>If the worksheet is protected, with a password, use this code to 
            unprotect it, show all, then turn the protection back on.</p>
          <pre>Sub ShowAllProtectedPwd()
Dim strPwd As String
strPwd = "yourpassword"

With ActiveSheet
    .Unprotect Password:=strPwd
    .ShowAllData
    .Protect _
        Contents:=True, _
        AllowFiltering:=True, _
        UserInterfaceOnly:=True, _
        Password:=strPwd
End With

End Sub</pre>
          <h2><br>
            <b><a name="On"></a>Turn On Excel AutoFilter <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>Use the following Excel AutoFilter VBA code to turn on an Excel AutoFilter, 
            if none exists</p>
          <pre>Sub TurnAutoFilterOn()
'check for filter, turn on if none exists
  If Not ActiveSheet.AutoFilterMode Then
    ActiveSheet.Range("A1").AutoFilter
  End If
End Sub
    </pre>
          <h2><b><a name="Off"></a>Turn Off Excel AutoFilter <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>Use the following Excel AutoFilter VBA code to turn off an Excel 
            AutoFilter, if one exists</p>
          <pre>Sub TurnFilterOff()
'removes AutoFilter if one exists
  Worksheets("Data").AutoFilterMode = False
End Sub    </pre>
          <h2><a name="ungroup"></a>Ungroup Dates in Filter Drop Down</h2>
          <p>By default, when you turn on an AutoFilter, dates are grouped in 
            the drop down list. You can <a href="http://www.contextures.com/xlautofilter02.html#ungroup">manually 
            change a setting</a>, to ungroup them, or use programming to turn 
            the grouping on or off.</p>
          <p>This code toggles the date grouping setting -- if the grouping is 
            on, it turns it off, and if grouping is off, the code turns it on.</p>
          <pre>Sub ToggleFilterDateGroup()
    ActiveWindow.AutoFilterDateGrouping _
    = Not ActiveWindow.AutoFilterDateGrouping
End Sub
</pre>
          <h2><b><a name="countfilters"></a>Count Worksheet AutoFilters <a href="http://www.contextures.com/xlautofilter03.html#Top"> 
            <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>If there is a worksheet AutoFilter on the active sheet, this code 
            will return a count of one.</p>
          <pre>Sub CountSheetAutoFilters()
Dim iARM As Long
'counts all worksheet autofilters
'even if all arrows are hidden
  If ActiveSheet.AutoFilterMode = True Then iARM = 1
  Debug.Print "AutoFilterMode: " &amp; iARM
End Sub     </pre>
          <h2><br>
            <b><a name="Hide"></a>Hide Excel AutoFilter Arrows <a href="http://www.contextures.com/xlautofilter03.html#Top"> 
            <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a><br>
            </b> </h2>
          <p>Perhaps you want users to filter only one of the columns in a table. 
            The following Excel AutoFilter VBA procedure hides the arrows for 
            all columns except column 2.</p>
          <p><img src="./Excel Filters -- AutoFilter VBA_files/AuF17.gif" width="202" height="52" border="1"></p>
          <blockquote> 
            <pre>Sub HideArrows() 
'hides all arrows except column 2
Dim c As Range 
Dim i As Integer 
i = Cells(1, 1).End(xlToRight).Column 
Application.ScreenUpdating = False 

For Each c In Range(Cells(1, 1), Cells(1, i))
 If c.Column &lt;&gt; 2 Then 
  c.AutoFilter Field:=c.Column, _ 
    Visibledropdown:=False 
 End If 
Next 

Application.ScreenUpdating = True 
End Sub 
</pre>
          </blockquote>
          <p>In other cases, you might want to hide the arrows on specific columns, 
            and leave all the other arrows visible. The following procedure hides 
            the arrows for columns 1, 3 and 4.</p>
          <blockquote> 
            <pre>Sub HideSpecifiedArrows()
'hides arrows in specified columns
Dim c As Range
Dim i As Integer
i = Cells(1, 1).End(xlToRight).Column
Application.ScreenUpdating = False

For Each c In Range(Cells(1, 1), Cells(1, i))
    Select Case c.Column
    Case 1, 3, 4
        c.AutoFilter Field:=c.Column, _
          Visibledropdown:=False
    Case Else
        c.AutoFilter Field:=c.Column, _
          Visibledropdown:=True
    End Select
Next

Application.ScreenUpdating = True
End Sub
</pre>
          </blockquote>
          <p>To show all the arrows, you can use the following Excel AutoFilter 
            VBA code: </p>
          <blockquote> 
            <pre>Sub ShowArrows()
Dim c As Range
Dim i As Integer
i = Cells(1, 1).End(xlToRight).Column
Application.ScreenUpdating = False
For Each c In Range(Cells(1, 1), Cells(1, i))
c.AutoFilter Field:=c.Column, _
  Visibledropdown:=True
Next
Application.ScreenUpdating = True
End Sub
</pre>
          </blockquote>
          <p>If your table doesn't start in cell A1, you can specify the heading 
            range, and hide arrows in specific cells in that range.</p>
          <blockquote> 
            <pre>Sub HideArrowsRange()
'hides arrows in specified range
Dim c As Range
Dim i As Integer
Dim rng As Range
Set rng = Range("D14:J14")
i = rng.Cells(1, 1).Column - 1
Application.ScreenUpdating = False

For Each c In Range("D14:J14")
    Select Case c.Address
    Case "$E$14", "$G$14", "$J$14"
        c.AutoFilter Field:=c.Column - i, _
          Visibledropdown:=False
    Case Else
        c.AutoFilter Field:=c.Column - i, _
          Visibledropdown:=True
    End Select
Next

Application.ScreenUpdating = True
End Sub
</pre>
          </blockquote>
          <p>If your table doesn't start in cell A1, you can specify the heading 
            range, and show all the arrows in that range.</p>
          <blockquote> 
            <pre>Sub ShowArrowsRange()
'shows arrows in specified range
Dim c As Range
Dim i As Integer
Dim rng As Range
Set rng = Range("D14:J14")
i = rng.Cells(1, 1).Column - 1
Application.ScreenUpdating = False
For Each c In Range("D14:J14")
    c.AutoFilter Field:=c.Column - i, _
      Visibledropdown:=True
Next
Application.ScreenUpdating = True
End Sub</pre>
          </blockquote>
          <h2><b><a name="Copy"></a>Copy Filtered Rows <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>The followingExcel AutoFilter VBA code copies the filtered rows from 
            the active sheet to Sheet2.</p>
          <blockquote> 
            <pre>Sub CopyFilter()
'by Tom Ogilvy
Dim rng As Range
Dim rng2 As Range

With ActiveSheet.AutoFilter.Range
 On Error Resume Next
   Set rng2 = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _
       .SpecialCells(xlCellTypeVisible)
 On Error GoTo 0
End With
If rng2 Is Nothing Then
   MsgBox "No data to copy"
Else
   Worksheets("Sheet2").Cells.<span class="goog_qs-tidbit goog_qs-tidbit-0">Clear
   Set rng = ActiveSheet.AutoFilter</span>.Range
   rng.Offset(1, 0).Resize(rng.Rows.Count - 1).Copy _
     Destination:=Worksheets("Sheet2").Range("A1")
End If
   ActiveSheet.ShowAllData

End Sub    </pre>
          </blockquote>
          <h2><b><a name="Protect"></a>Excel AutoFilter on a Protected Worksheet 
            <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>You can use an Excel AutoFilter on a protected worksheet, but you 
            can't create an Excel AutoFilter on a protected worksheet. <b>Ensure 
            that the filter is in place before the sheet is protected.</b> </p>
          <p>In <b>Excel 2002 and later versions</b>, you can allow users to use 
            AutoFilter when you set the worksheet protection. (see <i>Protect 
            Sheet</i> dialog box below)</p>
          <p><img src="./Excel Filters -- AutoFilter VBA_files/AuF18.gif" width="194" height="170" border="1"></p>
          <p>In <b>previous versions of Excel</b>, use a Workbook_Open macro to 
            set the protection to user interface only. Store the following Excel 
            AutoFilter VBA code on the <b>ThisWorkbook</b> module sheet. It also 
            turns on the AutoFilter is one is not in place: </p>
          <blockquote> 
            <pre>Private Sub Workbook_Open() 
'check for filter, turn on if none exists
With Worksheets("Data")
  If Not .AutoFilterMode Then
    .Range("A1").AutoFilter
  End If
  .EnableAutoFilter = True
  .Protect Password:="password", _
  Contents:=True, UserInterfaceOnly:=True
End With
End Sub 
</pre>
          </blockquote>
          <p>To access the <b>ThisWorkbook</b> module, right-click the Excel icon 
            to the left of the File menu, choose <b>View Code</b>, and paste the 
            code where the cursor is flashing.</p>
          <p><img src="./Excel Filters -- AutoFilter VBA_files/AuF24.gif" width="163" height="250" border="1"></p>
          <h2><b><a name="Count"></a>Count Visible Rows <a href="http://www.contextures.com/xlautofilter03.html#Top"> <img src="./Excel Filters -- AutoFilter VBA_files/scrollup.gif" width="9" height="11" border="0"></a></b></h2>
          <p>With this Excel AutoFilter VBA sample code, you can display a message 
            that shows a count of the rows that are visible after a filter has 
            been applied: </p>
          <p><img src="./Excel Filters -- AutoFilter VBA_files/AuF19.gif" width="227" height="117" border="1"></p>
          <pre>Sub CountVisRows()
'by Tom Ogilvy
Dim rng As Range
Set rng = ActiveSheet.AutoFilter.Range

MsgBox rng.Columns(1). _
   SpecialCells(xlCellTypeVisible).Count - 1 _
   &amp; " of " &amp; rng _
   .Rows.Count - 1 &amp; " Records"

End Sub
</pre>
          <p>&nbsp; </p>
          </blockquote>
      </td>
    </tr>
    <tr></tr>
    <tr> </tr>
    <tr> </tr>
  </tbody></table>
  
  <p><!--Begin---> <a href="http://www.exceluser.com/cmd.php?Clk=1197041"><img src="./Excel Filters -- AutoFilter VBA_files/info_dash_f01.gif" alt="Learn how to create Excel dashboards." width="728" height="90" border="0"></a> 
    <br>
    <img src="./Excel Filters -- AutoFilter VBA_files/cmd(3).php" width="0" height="0" border="0"> 
    <!--End---></p>
  <table width="90%" border="0">
    <tbody><tr> 
      <td width="53%"> 
        <blockquote> 
          <ol>
            <li><a href="http://www.contextures.com/xlautofilter01.html">Excel AutoFilter Basics </a></li>
            <li><a href="http://www.contextures.com/xlautofilter02.html">Excel AutoFilter Tips</a></li>
            <li><a href="./Excel Filters -- AutoFilter VBA_files/Excel Filters -- AutoFilter VBA.htm">Excel AutoFilter VBA</a></li>
            <li><a href="http://www.contextures.com/excelautofilterlist.html">Excel AutoFilter Lists VBA</a></li>
          </ol>
        </blockquote>
      </td>
      <td width="47%" valign="top"> 
<script type="text/javascript"><!--
google_ad_client = "ca-pub-9531091850463532";
/* 336x280LargeRecCtx */
google_ad_slot = "9508694968";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript" src="./Excel Filters -- AutoFilter VBA_files/show_ads.js">
</script><ins id="aswift_3_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
      </td>
    </tr>
    <tr> 
      <td width="53%">&nbsp; </td>
      <td width="47%">&nbsp;</td>
    </tr>
  </tbody></table>
  <p> 
  <!-- #BeginLibraryItem "/Library/Footer.lbi" --> 
<table cellspacing="0" cellpadding="0" border="0" width="80%">
  <tbody><tr bgcolor="#FFFFFF"> 
    <td colspan="4" valign="top"> 
      <div align="left"> 
        <div id="navbarfoot"> 
          <ul>
            <li><a href="http://www.contextures.com/">Home</a></li>
            <li><a href="http://www.contextures.com/tiptech.html">Excel Tips</a></li>
            <li><a href="http://www.contextures.com/excelfiles.html">Excel Files</a></li>
            <li><a href="http://www.contextures.com/contexturesproducts.html">Products</a></li>
            <li><a href="http://www.contextures.com/ExcelVideoTutorials.html">Videos</a></li>
            <li><a href="http://blog.contextures.com/">Blog</a></li>
            <li><a href="http://www.contextures.com/consult.html">Contact</a> 
            </li>
          </ul>
        </div>
        </div>
    </td>
  </tr>
  <tr bgcolor="#FFFFFF"> 
    <td width="81" valign="top"> 
      <p align="center">&nbsp;</p>
      <p align="center"><a href="http://www.contextures.com/privacy.html">Privacy Policy</a></p>
    </td>
    <td width="18" valign="top"> 
      <p>&nbsp;</p>
    </td>
    <td valign="bottom" width="322"> 
      <blockquote> 
        <p>Contextures Inc., Copyright ©2014<br>
          All rights reserved.</p>
        <p>&nbsp;</p>
      </blockquote>
    </td>
    <td valign="middle" width="120"> 
      <div align="center">
        <p><a href="https://mvp.support.microsoft.com/en-us/mvp/Debra%20Dalgleish-7612"><br>
          <img src="./Excel Filters -- AutoFilter VBA_files/MVPLogo06H.jpg" width="120" height="49" border="0" alt="MVP Logo"><br>
          </a><a href="https://mvp.support.microsoft.com/en-us/mvp/Debra%20Dalgleish-7612">Debra 
          Dalgleish <br>
          </a></p>
      </div>
    </td>
  </tr>
</tbody></table>
<!-- #EndLibraryItem --> 
  </p><p></p>
</blockquote>
<blockquote> 
  <blockquote> 
    <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Excel Filters -- AutoFilter VBA_files/ga.js" type="text/javascript"></script>
    <script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2794720-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </blockquote>
</blockquote>




<div id="goog_qs_tidbit_box" class="notranslate goog_qs-slideup"><div id="goog_qs-wrapper"><div id="goog_qs-box-toggle" title="Minimizar" style="background-image: url(chrome-extension://okanipcmceoeemlbjnmnbdibhgpbllgc/images/minimize.png);"></div><div id="goog_qs-box-help" title="Abrir a página de opções e a ajuda" style="background-image: url(chrome-extension://okanipcmceoeemlbjnmnbdibhgpbllgc/images/help.png);"></div><div id="goog_qs-box-info" style="background-image: url(chrome-extension://okanipcmceoeemlbjnmnbdibhgpbllgc/images/icon16x16.png);"><span class="goog_qs-nowrap">C<img>orrespondências</span> <span class="goog_qs-nowrap">n<img>a</span> <span class="goog_qs-nowrap">p<img>ágina</span> <span class="goog_qs-nowrap">p<img>ara</span> <span class="goog_qs-query"><span class="goog_qs-nowrap">c<img>lear</span> <span class="goog_qs-nowrap">A<img>utoFilter</span> <span class="goog_qs-nowrap">v<img>ba</span></span></div><div id="goog_qs-box-tidbits"><div class="goog_qs-box-tidbit" title="Clique para ver este texto na página"><em><span class="goog_qs-nowrap">C<img>lear</span></em> <span class="goog_qs-nowrap">S<img>et</span> <span class="goog_qs-nowrap">r<img>ng</span> = <span class="goog_qs-nowrap">A<img>ctiveSheet.</span><wbr><em><span class="goog_qs-nowrap">A<img>utoFilter</span></em>... <span class="goog_qs-go">»</span></div></div><div id="goog_qs-box-bottom"><div class="goog_qs-more-matches" id="goog_qs-box-more-tidbits"><span class="goog_qs-nowrap">M<img>ais</span> <span class="goog_qs-nowrap">c<img>orrespondências</span> <span class="goog_qs-go">»</span></div><div class="goog_qs-more-matches" id="goog_qs-box-fewer-tidbits" style="display:none"><span class="goog_qs-go">«</span>  <span class="goog_qs-nowrap">M<img>enos</span> <span class="goog_qs-nowrap">c<img>orrespondências</span></div><div id="goog_qs-box-feedback-link"><span class="goog_qs-nowrap">F<img>eedback</span></div> <div id="goog_qs-box-new-bug"><span class="goog_qs-nowrap">B<img>ug</span></div></div><div style="clear:both"></div></div></div></body></html>