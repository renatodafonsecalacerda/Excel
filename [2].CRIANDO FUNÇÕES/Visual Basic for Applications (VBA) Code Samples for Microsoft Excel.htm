<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0040)http://www.joyedaniels.com/vba_excel.htm -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><meta name="Description" content="Macro samples for Microsoft Excel programming"><meta name="keywords" content="visual basic for applications, vba, macros, microsoft excel"><title>Visual Basic for Applications (VBA) Code Samples for Microsoft Excel</title><meta name="GENERATOR" content="Microsoft FrontPage 6.0"><meta name="ProgId" content="FrontPage.Editor.Document"><!--mstheme--><link rel="stylesheet" type="text/css" href="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/sche1011.css"><meta name="Microsoft Theme" content="schemetealbrick 1011, default">
<meta name="Microsoft Border" content="tl, default">
</head><body><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><div align="left"><table border="0" cellpadding="0" width="749" id="table4" class="ms-grid1-0111-main" style="border-collapse: collapse"><tbody><tr><td width="138" class="ms-grid1-0111-tl"><p align="center" style="margin-top: 6px; margin-bottom: 12px"><span style="letter-spacing: 2pt"><b><font face="Arial" size="4"><a href="http://www.joyedaniels.com/"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/home_cmp_schemetealbrick010_gbtn.gif" width="95" height="20" border="0" alt="Home" align="middle"></a></font></b></span></p></td><td width="11" class="ms-grid1-0111-tl" valign="top">&nbsp;</td><td class="ms-grid1-0111-top" width="600"><h1 align="center" style="text-align: center; margin-top: 0; margin-bottom: 4px"><font face="Calisto MT" color="#BB0416" size="5">Joy E. Daniels</font><b><span style="font-family: Arial"><font color="#007777" size="5"> </font><font size="4">&nbsp;&nbsp;&nbsp; </font><font size="3">&#9830; Programming </font></span><font size="3"><span style="font-family: Arial">&#9830;</span></font><span style="font-family: Arial"><font size="3"> Reporting </font></span><font size="3"><span style="font-family: Arial">&#9830;</span></font><span style="font-family: Arial"><font size="3"> Support </font></span><font size="3"><span style="font-family: Arial">&#9830;</span></font></b></h1><p align="center" style="margin-top: 0; margin-bottom: 0"><b><font face="Arial" size="2"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/vba_excel.htm_cmp_schemetealbrick010_bnr.gif" width="600" height="60" border="0" alt="Excel VBA Code"></font></b> </p><p align="center" style="margin-top: 0; margin-bottom: 0">&nbsp;</p></td></tr></tbody></table></div></td></tr><!--msnavigation--></tbody></table><!--msnavigation--><table dir="ltr" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td valign="top" width="1%"><p style="height: 5; margin-top: 0; margin-bottom: 0"><font face="Marlett" color="#FFFFB7" size="2"><script language="JavaScript"><!--
MSFPhover = 
  (((navigator.appName == "Netscape") && 
  (parseInt(navigator.appVersion) >= 3 )) || 
  ((navigator.appName == "Microsoft Internet Explorer") && 
  (parseInt(navigator.appVersion) >= 4 ))); 
function MSFPpreload(img) 
{
  var a=new Image(); a.src=img; return a; 
}
// --></script><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav1n=MSFPpreload("_derived/services.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav1h=MSFPpreload("_derived/services.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/services.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav1&#39;].src=MSFPnav1h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav1&#39;].src=MSFPnav1n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/services.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="Services" name="MSFPnav1"></a><br><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav2n=MSFPpreload("_derived/clients.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav2h=MSFPpreload("_derived/clients.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/clients.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav2&#39;].src=MSFPnav2h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav2&#39;].src=MSFPnav2n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/clients.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="Clients" name="MSFPnav2"></a><br><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav3n=MSFPpreload("_derived/products.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav3h=MSFPpreload("_derived/products.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/products.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav3&#39;].src=MSFPnav3h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav3&#39;].src=MSFPnav3n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/products.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="Products" name="MSFPnav3"></a><br><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav4n=MSFPpreload("_derived/vba_code.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav4h=MSFPpreload("_derived/vba_code.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/vba_code.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav4&#39;].src=MSFPnav4h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav4&#39;].src=MSFPnav4n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/vba_code.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="VBA Code" name="MSFPnav4"></a><br><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav5n=MSFPpreload("_derived/keys_shortcut.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav5h=MSFPpreload("_derived/keys_shortcut.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/keys_shortcut.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav5&#39;].src=MSFPnav5h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav5&#39;].src=MSFPnav5n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/keys_shortcut.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="Shortcut Keys" name="MSFPnav5"></a><br><script language="JavaScript"><!--
if(MSFPhover) { MSFPnav6n=MSFPpreload("_derived/contact.htm_cmp_schemetealbrick010_vbtn.gif"); MSFPnav6h=MSFPpreload("_derived/contact.htm_cmp_schemetealbrick010_vbtn_a.gif"); }
// --></script><a href="http://www.joyedaniels.com/contact.htm" language="JavaScript" onmouseover="if(MSFPhover) document[&#39;MSFPnav6&#39;].src=MSFPnav6h.src" onmouseout="if(MSFPhover) document[&#39;MSFPnav6&#39;].src=MSFPnav6n.src"><img src="./Visual Basic for Applications (VBA) Code Samples for Microsoft Excel_files/contact.htm_cmp_schemetealbrick010_vbtn.gif" width="140" height="45" border="0" alt="Contact" name="MSFPnav6"></a></font> </p></td><td valign="top" width="24"></td><!--msnavigation--><td valign="top"><div align="left"><table border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse; mso-table-layout-alt: fixed; mso-border-alt: solid windowtext .5pt; mso-padding-alt: 0in 5.4pt 0in 5.4pt; border-style: none; border-width: medium" width="583"><tbody><tr><td width="108" style="border-left:.5pt solid windowtext; border-right:.5pt solid windowtext; border-top:3px solid #003333; border-bottom:3px solid #003333; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in" bgcolor="#FFFF00" align="center" height="30"><p class="MsoNormal" align="center"><b><font size="2">Description</font><o:p><font size="2"> </font></o:p></b></p></td><td width="444" style="mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top: 3px solid #003333; border-bottom: 3px solid #003333; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in" bgcolor="#FFFF00" align="center" height="30"><p class="MsoNormal" align="center"><b><font size="2">VBA Code</font><o:p><font size="2"> </font></o:p></b></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><font size="2"><b>Selecting</b></font></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Select 3 rows down, 2 columns right:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">ActiveCell.Offset(3, 2).Select</font></p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p class="MsoNormal" style="margin-bottom:0; margin-top:0"><font size="2"><span style="background-color: #00FF00">'==Select from active cell to last row of list:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">Range(Selection, Selection.End(xlDown)).Select</font></p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Select from current cell to last column of list:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">Range(Selection, Selection.End(xlToRight)).Select</font></p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Select last cell of worksheet:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in"><font size="2">Selection.SpecialCells(xlLastCell).Select</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><font size="2"><b>Pasting</b></font></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Paste formula value, not formula:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">Range("A3").Copy</font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">Range("D26").PasteSpecial Paste:=xlValues</font></p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p class="MsoNormal" style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Paste into a cell and move its original contents to the next cell:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in"><font size="2">Selection.Insert Shift:=xlToRight</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Columns and Rows</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'==Hide a column:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.EntireColumn.Hidden = True</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Insert a column:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Columns("N:N").Insert</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Delete columns:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Columns("B:E").EntireColumn.Delete</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Insert a new row at current cell:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.EntireRow.Insert</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Delete row of current cell:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.EntireRow.Delete</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Set column width:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.EntireColumn.ColumnWidth = 10</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Set row height:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.RowHeight = 26.25</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Set row height to size of contents:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">Selection.Rows.AutoFit</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Cell Formatting</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'==Text not wrapped:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.WrapText = False</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Remove color:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.Interior.ColorIndex = xlNone</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Set font size:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.Font.Size = 8</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Date and time format:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.NumberFormat = "mm-dd-yyyy hh:mm AM/PM"</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Number format with comma:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.NumberFormat = "#,##0"</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Left aligned:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.HorizontalAlignment = xlLeft</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Bottom aligned:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.VerticalAlignment = xlBottom</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Indented text:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.IndentLevel = 3</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Delete contents but not formatting:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Selection.ClearContents</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Delete contents and formatting:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">Selection.Clear</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Display</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'==Hide activity while macro runs:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Application.ScreenUpdating = False</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Turn off automatic alerts:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Application.DisplayAlerts = False</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Freeze&nbsp; panes:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">ActiveWindow.FreezePanes = True</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Show how long macro runs:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Dim strTime1 as String, strTime2 as String</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">strTime1 = Format(Now(), "mm-dd-yyyy hh:MM:ss")</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0"><font size="2">[put other macro code here]</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">strTime2 = Format(Now(), "mm-dd-yyyy hh:MM:ss")</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">MsgBox "Elapsed Time = " &amp; DateDiff("n", strTime1, strTime2)</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Range Names</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'==Add a range name:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">ActiveWorkbook.Names.Add Name:="Groups", RefersTo:=Selection</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Go to a named range:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Range("Groups").Select</font></p><p style="margin-top: 0; margin-bottom: 0">&nbsp;</p><p style="margin-top: 0; margin-bottom: 0"><font size="2"><span style="background-color: #00FF00">'==Delete all range names in workbook:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Dim n as Object</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">For Each n In ActiveWorkbook.Names</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">n.Delete</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">Next</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Path/File Name</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-bottom:0; margin-top:0.05in"><font size="2"><span style="background-color: #00FF00">'==Insert path/file name into a cell:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0"><font size="2">ActiveCell.Value = ActiveWorkbook.FullName</font></p><p class="MsoNormal" style="margin-top:0; margin-bottom:0">&nbsp;</p><p class="MsoNormal" style="margin-bottom:0; margin-top:0"><font size="2"><span style="background-color: #00FF00">'==Insert path/file name into a footer:</span></font></p><p class="MsoNormal" style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in"><font size="2">ActiveSheet.PageSetup.CenterFooter = ActiveWorkbook.FullName</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Pivot Tables</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'===Remove unused items in pivot tables when data has changed:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Dim pt As PivotTable, ws As Worksheet</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">For Each ws In ActiveWorkbook.Worksheets</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0"><font size="2">For Each pt In ws.PivotTables</font></p><p style="margin-left: 0.9in; margin-top: 0; margin-bottom: 0"><font size="2">pt.PivotCache.MissingItemsLimit = xlMissingItemsNone</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0"><font size="2">Next pt</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">Next ws</font></p></td></tr><tr><td width="108" valign="top" style="mso-border-top-alt: solid windowtext .5pt; border-left: .5pt solid windowtext; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p class="MsoNormal" style="margin-top: 0.05in; margin-bottom: 0"><b><font size="2">Worksheets</font></b></p></td><td width="444" valign="top" style="mso-border-top-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; border-left-style: none; border-left-width: medium; border-right: .5pt solid windowtext; border-top-style: none; border-top-width: medium; border-bottom: .5pt solid windowtext; padding-left: 5.4pt; padding-right: 5.4pt; padding-top: 0in; padding-bottom: 0in"><p style="margin-top: 0.05in; margin-bottom: 0" class="MsoNormal"><font size="2"><span style="background-color: #00FF00">'==Add date to title of each worksheet:</span></font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">Dim sht As Worksheet</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0" class="MsoNormal"><font size="2">For Each sht In ActiveWorkbook.Worksheets</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0"><font size="2">sht.Select</font></p><p style="margin-left: 0.6in; margin-top: 0; margin-bottom: 0"><font size="2">Range("A1").Value = Range("A1").Value &amp; " through " &amp; strDate</font></p><p style="margin-left: 0.3in; margin-top: 0; margin-bottom: 0.05in" class="MsoNormal"><font size="2">Next sht</font></p></td></tr></tbody></table></div><font size="2">&nbsp;</font><!--msnavigation--></td></tr><!--msnavigation--></tbody></table></body></html>