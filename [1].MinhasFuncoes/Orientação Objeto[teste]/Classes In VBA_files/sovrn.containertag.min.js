/*(c)2014 sovrn Holdings, Inc. All Rights Reserved*/if("undefined"==typeof sovrn)var sovrn={};"undefined"==typeof sovrn.Logger&&(sovrn.Logger=function(img,baseUrl){this.img=img,this.baseUrl=baseUrl},sovrn.Logger.prototype.reportError=function(errMsg,except,includeRandom){"undefined"==typeof includeRandom&&(includeRandom=!0);var msg="[Ads JS] ";try{msg+=errMsg;try{msg+=" - "+except.message}catch(e){}var rnd=includeRandom?"&r="+Math.floor(9e5*Math.random()):"";this.img.src=this.baseUrl+"/errors/ads?msg="+encodeURIComponent(msg)+rnd}catch(e){}});var rnd=Math.floor(999999999*Math.random()+1);if("undefined"==typeof sovrn)var sovrn={};"undefined"==typeof sovrn.dataLayer&&(sovrn.dataLayer=[{sovrnRandom:rnd}]),"undefined"==typeof sovrn.dataLayer[0].sovrnRandom&&(sovrn.dataLayer[0].sovrnRandom=rnd),"undefined"==typeof sovrn.getScriptTag&&(sovrn.getScriptTag=function(){if("currentScript"in document)return document.currentScript;var n,ct_regex=/sovrn\.containertag/,scripts=document.getElementsByTagName("script"),last=scripts[scripts.length-1];if(last.src.search(ct_regex)>=0)return last;try{for(n=scripts.length-1;n>=0;n--)if(scripts[n].src.search(ct_regex)>=0)return scripts[n]}catch(e){}return last}),"undefined"==typeof sovrn.requestParam&&(sovrn.requestParam=function(param){var script=this.getScriptTag();if(null!==script){var uri=script.src;return decodeURI(uri.replace(new RegExp("^(?:.*[&\\?]"+encodeURI(param).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}}),"undefined"==typeof sovrn.containers&&(sovrn.containers={}),"undefined"==typeof sovrn.containerTag&&(sovrn.containerTag=function(tags,logger){this.tags=tags,this.logger=logger,this.firedTags=[]},sovrn.containerTag.prototype.getImage=function(tag){var img=new Image;try{var src=this.createPath(tag);img.tag=tag,img.onload=function(){},img.onerror=function(e){"undefined"!=typeof this.logger&&this.logger.reportError(e.target.tag.error,{message:"Error: loading image"})},img.src=src,"undefined"!=typeof tag.fire&&"once"==tag.fire&&this.firedTags.push(tag.id)}catch(e){"undefined"!=typeof this.logger&&this.logger.reportError(tag.error,e)}},sovrn.containerTag.prototype.getScript=function(tag){try{var resource=document.createElement("script");resource.type="text/javascript",resource.text=tag.src,document.body.appendChild(resource)}catch(e){"undefined"!=typeof this.logger&&this.logger.reportError(tag.error,e)}},sovrn.containerTag.prototype.fire=function(){for(var i=0;i<this.tags.length;i++)if(this.checkRules(this.tags[i].rules)&&this.checkFreq(this.tags[i])&&this.checkFired(this.tags[i])){switch(this.tags[i].type){case"img":this.getImage(this.tags[i]);break;case"script":this.getScript(this.tags[i])}this.tags[i].fired=!0}},sovrn.containerTag.prototype.checkRules=function(rules){if(null===rules)return!0;for(var i=0;i<rules.length;i++){var retval=!1,value_1=this.getData(rules[i]["var"]),value_2=rules[i].value,operand=rules[i].operand;if(""===value_1)return alse;switch(operand){case"eq":retval=""+value_1==""+value_2;break;case"gt":retval=value_1>value_2;break;case"lt":retval=value_2>value_1;break;case"ct":retval=value_1.indexOf(value_2)>=0;break;default:return!1}if(retval===!1)return retval}return!0},sovrn.containerTag.prototype.checkFired=function(tag){return"undefined"==typeof tag.fire?!0:"once"!=tag.fire?!0:this.tagHasFired(tag.id)?!1:!0},sovrn.containerTag.prototype.checkFreq=function(tag){var cookieValue;switch(tag.frequency){case"sample":return 100*Math.random()<tag.percent;case"timed":var cookieName="fm_tag_"+tag.id+"_called";cookieValue=this.getData(cookieName);var date=new Date;return""!==cookieValue&&parseInt(cookieValue)>date.getTime()?!1:(date.setSeconds(date.getSeconds()+parseInt(tag.time)),document.cookie=cookieName+"="+date.getTime()+"; expires="+date.toUTCString()+"; path=/",!0);case"users":var modulo=Math.floor(1/(tag.percent/100));if(cookieValue=this.getData("ljt_reader"),32==cookieValue.length){var firstInt=parseInt(cookieValue.substr(0,8),16),secondInt=parseInt(cookieValue.substr(8,8),16),thirdInt=parseInt(cookieValue.substr(16,8),16),fourthInt=parseInt(cookieValue.substr(24,8),16);if((firstInt+secondInt+thirdInt+fourthInt)%modulo===0)return!0}return!1;default:return!0}},sovrn.containerTag.prototype.tagHasFired=function(tagId){for(var len=this.firedTags.length,i=0;len>i;i++)if(this.firedTags[i]==tagId)return!0;return!1},sovrn.containerTag.prototype.createPath=function(tag){var q="",symb="?";tag.src.indexOf("?")>0&&(symb="&");for(var i=0;i<tag.params.length;i++)q=q+symb+tag.params[i].key+"="+this.getData(tag.params[i]["var"]),symb="&";return tag.src+q},sovrn.containerTag.prototype.getData=function(key){if("object"==typeof sovrn.dataLayer&&"object"==typeof sovrn.dataLayer[0]&&"undefined"!=typeof sovrn.dataLayer[0][key])return sovrn.dataLayer[0][key];var cookieRegEx=new RegExp("(?:(?:^|.*;\\s*)"+key+"\\s*\\=\\s*([^;]*).*$)|^.*$"),cookieVal=document.cookie.replace(cookieRegEx,"$1");return cookieVal?cookieVal:""}),"undefined"==typeof sovrn.CTBootstrap&&(sovrn.CTBootstrap=function(containerDataUrl,host){var type=sovrn.requestParam("type"),cID=sovrn.requestParam("cid");if(this.host=host,"undefined"==typeof sovrn.containers["ct"+cID]){var resource=document.createElement("script"),zoneId=sovrn.requestParam("zid"),affId=sovrn.requestParam("aid"),idParam="";resource.type="text/javascript",resource.async=!0,affId.length>0?idParam="affId="+affId:zoneId.length>0&&(idParam="zoneId="+zoneId),resource.src=containerDataUrl+"?containerId="+cID+"&"+idParam;var script=document.getElementsByTagName("script")[0];script.parentNode.insertBefore(resource,script),resource.host=host,resource.addEventListener?resource.addEventListener("load",sovrn.CTFire):resource.readyState&&(resource.onloadDone=!1,resource.onload=function(){resource.onloadDone=!0,sovrn.CTFire()},resource.onreadystatechange=function(){"loaded"!==resource.readyState&&"complete"!==resource.readyState||resource.onloadDone||(resource.onloadDone=!0,sovrn.CTFire())})}else"multi"==type&&sovrn.CTFire()},sovrn.CTFire=function(){var logger=new sovrn.Logger(this.host),cID=containerData.containerId;if(sovrn.dataLayer[0].sovrnApplications=containerData.application_ids,sovrn.dataLayer[0].sovrnGeo=containerData.geo,sovrn.dataLayer[0].sovrnIid=containerData.user.iid,sovrn.dataLayer[0].sovrnUser=containerData.user.username,sovrn.dataLayer[0].sovrnReader=containerData.ljt_reader,sovrn.dataLayer[0].commscoreCategory=containerData.commscoreCategory,"undefined"==typeof sovrn.containers["ct"+cID]){var container=new sovrn.containerTag(containerData.tags,logger);sovrn.containers["ct"+cID]=container}else container=sovrn.containers["ct"+cID];container.fire()}),"undefined"==typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(searchElement,fromIndex){if(!this)throw new TypeError;fromIndex=+fromIndex,isNaN(fromIndex)&&(fromIndex=0);var length=this.length;if(0===length||fromIndex>=length)return-1;for(0>fromIndex&&(fromIndex+=length);length>fromIndex;)if(this[fromIndex++]===searchElement)return fromIndex;return-1}),sovrn.CTBootstrap("http://ap.lijit.com/containertag","http://www.lijit.com");